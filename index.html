<!DOCTYPE html>
<html lang="ja">
 <head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>阿賀野市人口ピラミッド</title>
<script>
var man2023 = [96,97,115,117,147,117,158,151,150,158,146,163,183,178,182,209,176,162,168,179,174,177,170,175,166,150,161,154,159,169,172,191,173,186,207,233,196,237,260,247,237,247,237,270,277,259,284,283,257,288,286,275,226,270,255,231,225,235,265,272,264,269,278,252,329,310,303,331,338,367,361,348,405,355,294,364,246,161,168,178,180,194,159,127,118,131,108,110,95,74,73,59,41,26,33,17,18,11,5,3,2];
var woman2023 = [79,127,126,123,120,125,152,143,128,151,182,167,159,140,150,161,158,164,157,182,159,171,137,150,166,141,131,154,158,150,135,152,171,176,181,205,196,216,234,233,224,237,238,216,244,240,276,245,251,275,243,258,235,239,245,270,237,214,264,230,288,278,282,315,308,302,300,319,355,335,403,333,393,398,363,378,276,182,200,221,227,274,208,236,189,207,223,221,194,193,191,138,141,117,108,79,43,71,34,34,52];
var man2022 = [88,112,112,149,117,153,153,150,157,149,164,182,177,181,208,178,162,176,173,183,172,179,169,176,151,172,155,163,166,173,191,163,183,210,225,195,238,259,249,239,248,243,271,275,258,290,284,258,288,284,277,225,267,257,230,226,236,265,274,259,268,282,256,332,312,304,336,346,369,371,355,416,372,302,371,257,167,174,189,185,201,164,134,128,149,118,130,106,90,81,64,50,38,46,23,24,18,6,4,2,1];
var woman2022 = [120,124,122,116,124,151,141,128,151,180,168,159,141,150,161,158,163,170,182,175,182,144,149,173,143,132,152,158,153,133,145,167,175,182,201,203,214,227,230,231,234,236,213,241,237,276,245,249,275,244,255,235,239,245,269,240,214,264,229,287,278,286,313,309,304,302,322,358,337,407,334,396,401,364,380,281,184,203,226,234,283,210,238,199,225,238,245,203,212,217,154,157,140,127,107,67,94,48,40,25,50];
var man2021 = [108,109,149,113,151,150,147,156,149,162,181,177,181,209,178,162,178,186,186,176,190,196,181,162,184,167,163,167,175,190,166,185,209,227,201,235,254,248,234,246,243,275,274,256,290,285,257,287,289,278,224,267,254,236,227,235,269,274,257,269,284,256,333,311,307,337,347,380,378,368,419,384,310,382,269,173,182,198,191,208,173,139,137,160,129,141,120,102,90,74,62,44,61,29,30,20,7,4,4,1,1];
var woman2021 = [117,120,108,124,153,142,129,153,179,166,159,143,150,161,157,164,170,195,182,197,154,162,183,143,133,156,154,153,145,147,175,180,191,203,204,216,234,231,232,231,239,211,241,242,278,247,247,280,246,254,237,240,246,270,236,213,267,231,288,279,286,313,313,305,304,324,361,338,408,334,399,405,366,381,289,186,206,228,235,287,214,243,201,233,251,254,210,226,238,172,173,159,144,126,82,110,56,47,36,34,38];
var man2020 = [100,147,111,145,147,143,155,148,158,180,175,183,208,180,162,180,187,198,181,198,203,197,168,192,173,173,170,184,190,167,192,208,228,193,244,248,242,234,244,246,273,275,258,293,290,261,291,289,279,228,267,256,238,228,232,273,275,257,270,283,254,336,312,308,337,350,380,382,378,426,387,318,392,269,178,185,206,204,213,182,143,142,166,140,154,135,117,107,85,71,55,71,32,37,27,10,6,7,1,1,4];
var woman2020 = [113,107,122,153,141,128,153,179,168,158,143,150,162,158,167,171,191,189,206,164,176,206,145,142,170,153,151,144,142,173,176,190,211,204,221,232,234,230,231,234,210,244,243,279,246,249,285,247,255,235,241,244,270,234,214,268,230,289,276,284,313,316,307,304,327,363,339,413,334,401,405,368,385,292,188,209,234,235,292,222,249,205,239,257,263,225,236,252,187,192,183,159,136,100,123,75,60,44,42,13,45];
var man2019 = [139,111,139,144,144,153,148,157,178,175,182,211,181,162,180,189,199,204,203,208,201,176,196,176,179,174,181,191,169,189,209,223,195,242,245,238,234,243,248,276,276,258,296,291,265,295,294,281,231,265,254,234,230,231,275,273,258,271,286,258,341,315,310,343,355,385,386,379,432,397,325,401,273,184,190,213,209,222,190,154,150,175,147,171,147,131,122,93,82,64,81,44,47,31,14,10,7,2,1,3,3];
var woman2019 = [99,119,149,144,123,151,178,167,158,141,150,160,157,168,170,192,193,215,162,183,223,163,155,183,163,170,149,135,166,174,197,206,204,229,233,233,227,233,235,212,244,246,279,251,252,287,249,257,233,245,249,270,236,215,267,228,292,276,287,315,316,308,305,333,363,339,415,334,407,411,369,383,296,189,209,238,240,294,225,253,214,249,263,269,238,244,268,200,203,198,186,156,117,144,91,71,57,52,19,26,42];
var man2018 = [109,140,145,143,152,146,158,177,177,183,211,183,162,181,189,198,204,224,208,217,183,221,188,189,180,183,201,171,191,218,225,196,245,245,241,236,247,246,279,278,262,298,296,266,296,291,282,229,269,254,235,229,234,275,274,256,272,283,260,344,313,312,347,354,387,392,380,436,403,331,412,284,188,196,219,215,233,199,162,158,186,163,184,158,136,138,103,95,80,89,52,56,37,23,13,7,5,3,5,0,4];
var woman2018 = [117,148,145,123,151,176,169,158,141,149,160,159,168,171,192,192,213,176,184,245,171,187,189,171,179,166,150,175,178,210,206,207,230,231,230,226,230,234,212,246,247,280,247,252,290,248,256,236,245,247,273,235,217,269,231,291,273,287,314,317,310,309,335,364,343,416,335,407,414,373,383,303,189,212,239,244,298,227,258,221,255,275,277,246,246,282,211,217,215,202,172,133,156,102,84,74,63,28,29,18,48];
var man2017 = [128,142,135,149,145,161,176,175,182,212,181,164,180,190,202,204,225,230,222,195,227,192,199,189,193,214,181,196,219,222,198,238,246,236,237,246,248,279,281,264,300,297,267,298,293,286,228,270,256,232,228,237,273,274,259,272,282,262,342,316,320,347,358,391,398,382,442,408,338,417,292,192,202,226,224,241,203,166,164,199,171,199,171,151,153,111,104,87,105,67,64,42,39,17,13,8,7,5,1,1,4];
var woman2017 = [136,145,119,152,173,167,157,144,148,162,162,168,173,194,191,214,177,196,238,178,194,219,178,182,168,162,180,184,207,200,205,228,232,234,224,237,240,213,242,245,286,251,250,295,246,260,235,244,251,270,239,219,272,231,291,275,288,313,317,309,308,334,365,348,418,338,407,419,374,390,308,190,213,238,247,302,228,257,224,264,281,285,249,255,293,226,238,235,218,195,153,177,122,94,85,71,39,41,22,21,44];
var man2016 = [130,136,144,143,159,177,174,180,209,182,164,180,190,203,203,225,232,236,208,233,203,224,195,205,223,192,197,227,217,202,244,246,246,235,247,252,283,278,267,300,298,269,301,296,287,232,273,258,235,231,234,278,274,264,278,281,267,344,319,321,346,358,393,408,388,442,411,342,422,292,194,207,234,230,248,214,171,171,210,184,210,174,167,167,117,114,100,115,76,77,53,50,26,20,14,10,7,2,1,3,4];
var woman2016 = [134,122,152,171,167,155,143,149,164,161,169,173,193,191,214,176,199,260,179,200,237,210,189,171,174,195,192,210,213,208,234,233,239,221,229,240,213,250,246,283,250,249,295,245,261,237,242,247,273,239,220,273,231,292,273,289,313,320,311,307,338,363,350,419,340,410,422,378,390,311,189,213,238,249,304,232,260,224,272,284,286,257,256,308,240,247,247,237,206,166,193,135,110,99,89,50,50,33,25,17,40];
var man2015 = [135,144,145,156,179,177,181,208,182,168,180,190,203,202,227,234,234,217,232,207,234,208,216,230,199,196,228,216,201,246,249,243,240,249,245,284,284,268,300,299,274,299,295,291,235,272,259,233,229,233,285,273,262,280,281,265,347,323,325,349,359,395,412,397,447,415,354,425,295,198,215,241,239,255,220,181,175,217,194,226,188,176,177,136,132,115,124,93,90,67,59,34,26,14,17,7,5,3,4,4,2];
var woman2015 = [118,147,174,166,158,141,145,164,164,171,173,194,191,214,177,200,263,191,201,245,214,203,191,180,207,204,218,225,206,240,228,233,227,225,246,212,251,249,294,253,253,298,245,265,237,236,249,275,243,216,275,231,292,276,291,311,319,311,309,340,364,351,420,339,409,422,375,390,313,190,218,240,250,309,238,260,224,277,291,293,265,265,317,250,258,259,257,225,181,216,150,132,114,103,59,54,35,32,20,27,23];
var man2014 = [136,148,155,179,175,178,208,181,170,178,190,203,201,226,235,235,218,248,209,241,216,220,235,204,210,227,221,205,245,259,242,248,249,251,284,281,269,299,298,279,297,295,282,234,273,260,234,231,234,286,272,259,281,280,263,348,322,327,351,365,396,412,402,453,417,358,430,300,202,220,245,244,259,228,187,180,219,201,233,198,190,185,147,145,127,131,104,98,76,67,41,33,18,22,11,7,5,5,5,3,0];
var woman2014 = [145,175,163,154,143,149,166,163,169,175,195,190,212,178,203,264,192,210,245,225,219,210,192,216,210,217,223,211,237,232,238,228,227,248,208,258,252,303,258,253,300,248,261,239,237,248,273,241,219,273,233,297,276,296,312,320,311,309,342,364,351,420,341,410,423,373,391,313,186,221,240,251,310,241,262,225,281,295,295,273,274,331,263,269,269,266,238,198,226,165,144,130,120,76,59,46,41,24,33,13,27];
var man2013 = [138,153,176,176,174,207,179,173,179,188,205,205,227,234,233,218,250,222,244,225,223,232,202,225,232,231,205,241,268,248,247,249,253,287,289,263,296,295,275,299,297,280,233,273,256,233,232,235,286,276,263,280,281,265,347,326,331,353,366,396,415,405,454,425,363,432,308,207,226,251,249,267,235,189,185,228,205,236,210,194,190,153,160,139,148,121,112,87,77,51,36,23,27,13,8,12,6,7,7,0,4];
var woman2013 = [170,163,151,140,154,164,164,171,175,196,190,213,179,203,264,194,210,251,224,221,211,202,229,227,223,232,218,249,245,230,225,226,244,217,258,252,297,253,260,300,248,262,239,234,251,274,241,219,274,236,297,276,300,313,320,310,314,345,362,352,420,341,412,423,375,392,312,190,221,241,254,311,241,266,229,286,301,295,281,277,339,271,279,285,278,251,219,236,183,155,145,132,98,72,54,48,31,34,22,22,22];
function draw(man, woman, year) {
    // 変数canvasにtutorialというidのcanvasをいれる
    var canvas = document.getElementById('tutorial');
    //　もしcanvasが取得できたら
    if (canvas.getContext) {
        // ctxという変数にペンを持たせる
        var ctx = canvas.getContext('2d');
        // ここからPath(道順)をはじめる
        ctx.clearRect(0,0,350,350);
        ctx.strokeStyle = 'rgba(0, 0, 0, 0.6)';
        ctx.lineWidth = 0.7;
        ctx.beginPath();
        ctx.moveTo(0, 326);
        ctx.lineTo(150, 326);
        ctx.moveTo(200, 326);
        ctx.lineTo(350, 326);
        ctx.moveTo(150, 25);
        ctx.lineTo(150, 325);
        ctx.moveTo(200, 25);
        ctx.lineTo(200, 325);
        var x = 150
        var zinkou = 0
        ctx.font = '10px sans-serif'
        for (var i = 0; i < 6; i++) {
            ctx.moveTo(x, 326)
            ctx.lineTo(x, 335)
            if (zinkou == 0) {
                ctx.fillText(zinkou, x - 3, 345)
            } else {
                ctx.fillText(zinkou, x - 9, 345)
            }
            
            x = x - 25
            zinkou = zinkou + 100
        }
        x = 200
        zinkou = 0
        for (var i = 0; i < 6; i++) {
            ctx.moveTo(x, 326)
            ctx.lineTo(x, 335)
            if (zinkou == 0) {
                ctx.fillText(zinkou, x - 3, 345)
            } else {
                ctx.fillText(zinkou, x - 9, 345)
            }

            x = x + 25
            zinkou = zinkou + 100
        }
        ctx.fillText('(人)', 330, 335)
        ctx.stroke()
        ctx.font = '15px sans-serif';
        ctx.fillText('男性', 65, 20);
        ctx.fillText('女性', 265, 20);
        ctx.font = '15px sans-serif'
        ctx.fillText(year + '年4月', 250, 320)
        ctx.font = '8px sans-serif';
        var y = 30;
        var age = 100;
        for (var i = 0; i < 21; i++) {
            if (age == 100) {
                ctx.fillText(age + '歳以上', 160, y);
            } else {
                ctx.fillText(age + '歳', 160, y);
            }
            y += 15;
            age -= 5;
        } 
        y = 324.5;
        var total = 0;
        var nenshou = 0;
        var rounen = 0;
        for (var i = 0; i < 101; i++) {
            ctx.beginPath();
            if (i < 15) {
                ctx.strokeStyle = 'rgba(0, 250, 0, 0.7)';
                nenshou = nenshou + man[i] + woman[i];
            } else if (i < 65) {
                ctx.strokeStyle = 'rgba(0, 0, 250, 0.7)';
            } else {
                ctx.strokeStyle = 'rgba(250, 0, 0, 0.7)';
                rounen = rounen + man[i] + woman[i];
            }
            ctx.lineWidth = 3;
            ctx.moveTo(150, y);
            ctx.lineTo(150 - man[i] / 4, y);
            ctx.moveTo(200, y);
            ctx.lineTo(200 + woman[i] / 4, y);
            ctx.stroke();
            y -= 3;
            total = total + man[i] + woman[i];
        }
        var nenshouhiritu = Math.round(nenshou / total * 10000) / 100;
        var rounenhiritu = Math.round(rounen / total * 10000) / 100;
        ctx.font = '15px sans-serif'
        ctx.fillText('年少人口', 10, 303)
        ctx.fillText(nenshouhiritu + '％',10 , 319)
        ctx.fillText('老年人口', 10, 70)
        ctx.fillText(rounenhiritu + '％', 10, 87)
    }
}
function test() {
    var slider = document.getElementById('slider');
    if (slider.value == 2022) {
        draw(man2022, woman2022, 2022);
    } 
    if (slider.value == 2023) {
        draw(man2023, woman2023, 2023);
    }
    if (slider.value == 2021) {
        draw(man2021, woman2021, 2021);
    }
    if (slider.value == 2020) {
        draw(man2020, woman2020, 2020);
    }
    if (slider.value == 2019) {
        draw(man2019, woman2019, 2019);
    }
    if (slider.value == 2018) {
        draw(man2018, woman2018, 2018);
    }
    if (slider.value == 2017) {
        draw(man2017, woman2017, 2017);
    }
    if (slider.value == 2016) {
        draw(man2016, woman2016, 2016);
    }
    if (slider.value == 2015) {
        draw(man2015, woman2015, 2015);
    }
    if (slider.value == 2014) {
        draw(man2014, woman2014, 2014);
    }
    if (slider.value == 2013) {
        draw(man2013, woman2013, 2013)
    }
}
</script>
<style>
/* canvasの境界線を1pxの黒の実線で塗る */
canvas {
    border: 1px solid black;
    /* 1つ1つの要素を縦に並べる */
    display: block;
    /* 余白を左右均等にする */
    margin: auto;
}   
input {
    display: block;
    margin: auto;
    width : 350px;
}
h1 {
    text-align: center;
    font-size: 25px;
}
p {
    text-align: center;
}
</style>
</head>   
<!-- bodyがloadされた時にdrawという関数を実行する -->
<body onload="draw(man2023, woman2023, 2023);">
<h1>阿賀野市人口ピラミッド</h1>
<p>2013年~2023年</p>
<canvas id="tutorial" width="350" height="350"></canvas>
<br>
<input type="range" min="2013" max="2023" value="2023" step="1" onchange="test()" id="slider" list="markers">
<datalist id="markers">
    <option value="2013"></option>
    <option value="2014"></option>
    <option value="2015"></option>
    <option value="2016"></option>
    <option value="2017"></option>
    <option value="2018"></option>
    <option value="2019"></option>
    <option value="2020"></option>
    <option value="2021"></option>
    <option value="2022"></option>
    <option value="2023"></option>
</datalist>
<p>スライダーを動かすと人口ピラミッドの変化が見られます</p>
<p>データ出典：「住民基本台帳」（阿賀野市）</p>
 </body>
</html>